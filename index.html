<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>project_milestone_report</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 17pt; }
 .s2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 h1 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 .p, p { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; margin:0pt; }
 .a { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h2 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s3 { color: black; font-family:Monaco, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li>*:first-child:before {counter-increment: c1; content: counter(c1, decimal)" "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 #l1> li:first-child>*:first-child:before {counter-increment: c1 0;  }
 #l2 {padding-left: 0pt; }
 #l2> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l3 {padding-left: 0pt;counter-reset: d1 1; }
 #l3> li>*:first-child:before {counter-increment: d1; content: counter(d1, decimal)". "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l4 {padding-left: 0pt;counter-reset: e1 1; }
 #l4> li>*:first-child:before {counter-increment: e1; content: counter(e1, decimal)". "; color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: e1 0;  }
</style></head><body><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-top: 2pt;padding-left: 62pt;text-indent: 0pt;line-height: 112%;text-align: center;padding-right: 62pt">Project Milestone Report: No-Wait Fork-Join Continuation Stealing Framework</p><p class="s2" style="padding-top: 11pt;padding-left: 87pt;text-indent: 0pt;line-height: 170%;text-align: center;">Zhengjia Cao (zhengjic) &amp; Jingzhi Zhang (jingzhi2) November 28, 2022</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l1"><li data-list-text="1"><h1 style="padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark0">Submission</a></h1><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;"><a href="https://euigfdbguiwerin93.github.io/project-milestone-report/" class="a" target="_blank">This document can be found on our project page </a>here as well as Gradescope.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="2"><h1 style="padding-top: 6pt;padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark1">Latest schedule</a></h1><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;padding-right:50pt">Considering our original goals and current progress, we devise a new schedule with the assignee per half week as follows. This updated schedule will be also posted on our project site.</p><p style="padding-left: 62pt;text-indent: 0pt;line-height: 13pt;text-align: justify;padding-right:50pt"><b>12/1 – 12/4 </b>referring to an open-source C++20 coroutine-based scheduler, Forkpool, implement our continuation-stealing fork-join framework</p><ul id="l2"><li data-list-text="•"><p style="padding-top: 8pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">jingzhi2: continuation-stealing mechanism.</p></li><li data-list-text="•"><p style="padding-top: 8pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">zhengjic: wait-free and lock-free features.</p><h2 style="padding-top: 8pt;padding-left: 47pt;text-indent: 14pt;text-align: left;">12/5 – 12/7<span class="p">: Find the bottleneck on execution time and space. Propose a potential fix or update.</span></h2></li><li data-list-text="•"><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">jingzhi2: write test suites and conduct experiments via several classic fork-join applications like Fibonacci and N-Queens.</p></li><li data-list-text="•"><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">zhengjic: analyze the accumulated experiment data and propose solutions.</p><h2 style="padding-top: 8pt;padding-left: 47pt;text-indent: 14pt;text-align: left;">12/8 – 12/11<span class="p">: Prototype our solutions and evaluate its outcome in a considerable scale.</span></h2></li><li data-list-text="•"><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">jingzhi2: improve the test suites for benchmark. Add a visualization tool.</p></li><li data-list-text="•"><p style="padding-top: 8pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">zhengjic: make a prototype of the proposed solution with evaluation.</p><h2 style="padding-top: 8pt;padding-left: 62pt;text-indent: 0pt;text-align: justify;">12/12 – 12/14<span class="p">: Finalize our findings.</span></h2></li><li data-list-text="•"><p style="padding-top: 8pt;padding-left: 72pt;text-indent: -10pt;text-align: left;">jingzhi2: do benchmark on our implementation and predecessors like Cilk and Nowa.<p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="•"><p style="padding-left: 72pt;text-indent: -10pt;text-align: justify;">zhengjic: finalize the codebase. Propose some potential future directions to further optimizations.</p><h2 style="padding-top: 6pt;padding-left: 62pt;text-indent: 0pt;text-align: left;">12/15 – 12/17<span class="p">: Write reports and prepare for the poster session together.</span></h2><h2 style="padding-left: 62pt;text-indent: 0pt;text-align: left;">12/18<span class="p">: Poster session!</span></h2><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li data-list-text="3"><h1 style="padding-top: 5pt;padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark2">Completed work</a></h1><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;padding-right:50pt">In the past three weeks, we have completed implementing a basic fork join framework with child stealing using pthread. We’ve also exploited optimizations like using threadpool instead of creating a new thread for every fork operation. After having the basic framework executable, we’ve tested it’s performance using a simple Fibonacci number program.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="4"><h1 style="padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark3">List of deliverables</a></h1><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;padding-right:50pt">Overall, we are approaching our original goals smoothly. More description about the progress can be found in the section of Completed Work, Preliminary Results, and Concerning Issues.</p><p style="padding-left: 47pt;text-indent: 14pt;text-align: justify;padding-right:50pt">Here we come up with a new list of deliverables to hit for the poster, in order to reflect the latest schedule, which is essentially the same as the original one.</p><ol id="l3"><li data-list-text="1."><p style="padding-top: 8pt;padding-left: 72pt;text-indent: -12pt;line-height: 79%;text-align: left;">A no-wait, lock-free, and continuation-stealing fork-join framework based on C++20 coroutines.</p></li><li data-list-text="2."><p style="padding-top: 6pt;padding-left: 72pt;text-indent: -12pt;text-align: justify;padding-right:50pt">A test suite to apply the above framework on classic fork-join problems like Fibonacci and N-Queens, accumulating performance data to measure the speedup and indicate the bottleneck.</p></li><li data-list-text="3."><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -12pt;text-align: justify;padding-right:50pt">A benchmark platform with visualization tools to compare our framework with state-of-the-art solutions like Cilk and Nowa.</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="5"><h1 style="padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark4">Poster session plan</a></h1><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;">In the poster session, we plan to show:</p><ol id="l4"><li data-list-text="1."><p style="padding-top: 4pt;padding-left: 72pt;text-indent: -12pt;line-height: 88%;text-align: left;">A straightforward code demo about how to write C<span class="s3">++ </span>parallel programs in the fork-join style via our framework.</p></li><li data-list-text="2."><p style="padding-top: 8pt;padding-left: 72pt;text-indent: -12pt;text-align: left;">A diagram modeling our framework.</p></li><li data-list-text="3."><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -12pt;text-align: left;">A plot showing the speedup benchmark of our framework on various types of workload compared to other state-of-the-art solutions.</p></li><li data-list-text="4."><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -12pt;text-align: left;">Several plots showing the breakdown of time and space consumption to illustrate our advantages as well as disadvantages.</p></li><li data-list-text="5."><p style="padding-top: 7pt;padding-left: 72pt;text-indent: -12pt;text-align: left;">Discussion about the current solution and future directions.</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 59pt;text-indent: 0pt;text-align: left;"><span><div style="padding-left: 47pt;text-align:center"><img width="430" height="250" alt="image" src="project_milestone_report_files/Image_001.jpg"/></div></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: center;"><a name="bookmark5">Figure 1: Performance testing of our simple fork join framework using Fibonacci numbers.</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="6"><h1 style="padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark6">Preliminary results</a></h1><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;padding-right:50pt">We have tested our framework using Fibonacci number program to analyze the performance bottlenecks. We have used the GHC machines as our testing environment.</p><p style="padding-left: 47pt;text-indent: 14pt;text-align: justify;padding-right: 50pt;padding-right:50pt"><a href="#bookmark5" class="a">As shown in </a>Figure 1, the execution time decreased from 36 seconds (we performed this measurement using our framework with single thread execution) to 15 seconds using 4 threads. The CPU utilization also improves as the thread number increase, until it drops when the number of threads increases to 8. We believe this is caused by the lock contention on threads work queues. In our current implementation, the task queue for each thread is locked using a single pthread mutex. One potential improvement would be changing the work queue to be lock-free.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li data-list-text="7"><h1 style="padding-left: 71pt;text-indent: -24pt;text-align: left;"><a name="bookmark7">Concerning issues</a></h1></li></ol><p style="padding-top: 9pt;padding-left: 47pt;text-indent: 0pt;text-align: left;padding-bottom: 50pt;padding-right:50pt">It is challenging for us to implement continuation stealing using our current implementation of the fork-join framework. We are considering to re-implement our current framework using coroutine from C++20 to pass the continuation of a task.</p></body></html>
